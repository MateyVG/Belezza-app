{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{createClient}from'@supabase/supabase-js';import{useAuth}from'../context/AuthContext';import'../styles/Admin.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const supabaseUrl='https://lnquyopfvuikhjbjsiqk.supabase.co';const supabaseKey='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxucXV5b3BmdnVpa2hqYmpzaXFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0ODA5MDEsImV4cCI6MjA2MTA1NjkwMX0.GmZ-5FzZkJyMorLGggF_Jegx2Atn0wRiNKCx4esecJw';const supabase=createClient(supabaseUrl,supabaseKey);function Profile(){const{user}=useAuth();const[name,setName]=useState('');const[phone,setPhone]=useState('');const[loading,setLoading]=useState(true);const[updating,setUpdating]=useState(false);const[error,setError]=useState(null);const[success,setSuccess]=useState(false);useEffect(()=>{const fetchProfile=async()=>{try{setLoading(true);// Проверка дали имаме потребител\nif(!user)return;// Зареждане на профилни данни\nconst{data,error}=await supabase.from('profiles').select('*').eq('id',user.id).single();if(error&&error.code!=='PGRST116'){throw error;}if(data){setName(data.full_name||'');setPhone(data.phone||'');}}catch(error){console.error('Грешка при зареждане на профила:',error);setError('Възникна грешка при зареждане на вашия профил');}finally{setLoading(false);}};fetchProfile();},[user]);const handleUpdate=async e=>{e.preventDefault();try{setUpdating(true);setError(null);setSuccess(false);// Актуализиране или създаване на профилни данни\nconst{error}=await supabase.from('profiles').upsert({id:user.id,full_name:name,phone:phone,updated_at:new Date()});if(error)throw error;setSuccess(true);}catch(error){console.error('Грешка при актуализиране на профила:',error);setError('Възникна грешка при запазване на данните');}finally{setUpdating(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px',textAlign:'center',color:'#e0e0e0'},children:\"\\u0417\\u0430\\u0440\\u0435\\u0436\\u0434\\u0430\\u043D\\u0435 \\u043D\\u0430 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"auth-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-card\",style:{maxWidth:'600px'},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u041C\\u043E\\u044F\\u0442 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"auth-error\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#1e392a',color:'#4cd964',padding:'15px',borderRadius:'8px',marginBottom:'20px',border:'1px solid #2a6239'},children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044A\\u0442 \\u0431\\u0435\\u0448\\u0435 \\u0430\\u043A\\u0442\\u0443\\u0430\\u043B\\u0438\\u0437\\u0438\\u0440\\u0430\\u043D \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E!\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpdate,className:\"auth-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{id:\"email\",type:\"email\",value:(user===null||user===void 0?void 0:user.email)||'',disabled:true,className:\"disabled-input\"}),/*#__PURE__*/_jsx(\"small\",{style:{color:'#aaaaaa',marginTop:'5px',display:'block'},children:\"Email \\u0430\\u0434\\u0440\\u0435\\u0441\\u044A\\u0442 \\u043D\\u0435 \\u043C\\u043E\\u0436\\u0435 \\u0434\\u0430 \\u0431\\u044A\\u0434\\u0435 \\u043F\\u0440\\u043E\\u043C\\u0435\\u043D\\u044F\\u043D\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"\\u0418\\u043C\\u0435 \\u0438 \\u0444\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"input\",{id:\"name\",type:\"text\",value:name,onChange:e=>setName(e.target.value),placeholder:\"\\u0412\\u0430\\u0448\\u0435\\u0442\\u043E \\u0438\\u043C\\u0435\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"phone\",children:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0435\\u043D \\u043D\\u043E\\u043C\\u0435\\u0440\"}),/*#__PURE__*/_jsx(\"input\",{id:\"phone\",type:\"tel\",value:phone,onChange:e=>setPhone(e.target.value),placeholder:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0435\\u043D \\u043D\\u043E\\u043C\\u0435\\u0440\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"auth-button\",disabled:updating,children:updating?'Запазване...':'Запази промените'})]})]})});}export default Profile;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","createClient","useAuth","jsx","_jsx","jsxs","_jsxs","supabaseUrl","supabaseKey","supabase","Profile","user","name","setName","phone","setPhone","loading","setLoading","updating","setUpdating","error","setError","success","setSuccess","fetchProfile","data","from","select","eq","id","single","code","full_name","console","handleUpdate","e","preventDefault","upsert","updated_at","Date","style","padding","textAlign","color","children","className","maxWidth","backgroundColor","borderRadius","marginBottom","border","onSubmit","htmlFor","type","value","email","disabled","marginTop","display","onChange","target","placeholder"],"sources":["D:/Belezza/restaurant-chain-app/src/pages/Profile.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport '../styles/Admin.css';\r\n\r\nconst supabaseUrl = 'https://lnquyopfvuikhjbjsiqk.supabase.co';\r\nconst supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxucXV5b3BmdnVpa2hqYmpzaXFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0ODA5MDEsImV4cCI6MjA2MTA1NjkwMX0.GmZ-5FzZkJyMorLGggF_Jegx2Atn0wRiNKCx4esecJw';\r\nconst supabase = createClient(supabaseUrl, supabaseKey);\r\n\r\nfunction Profile() {\r\n  const { user } = useAuth();\r\n  const [name, setName] = useState('');\r\n  const [phone, setPhone] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [updating, setUpdating] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [success, setSuccess] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchProfile = async () => {\r\n      try {\r\n        setLoading(true);\r\n        \r\n        // Проверка дали имаме потребител\r\n        if (!user) return;\r\n        \r\n        // Зареждане на профилни данни\r\n        const { data, error } = await supabase\r\n          .from('profiles')\r\n          .select('*')\r\n          .eq('id', user.id)\r\n          .single();\r\n        \r\n        if (error && error.code !== 'PGRST116') {\r\n          throw error;\r\n        }\r\n        \r\n        if (data) {\r\n          setName(data.full_name || '');\r\n          setPhone(data.phone || '');\r\n        }\r\n      } catch (error) {\r\n        console.error('Грешка при зареждане на профила:', error);\r\n        setError('Възникна грешка при зареждане на вашия профил');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchProfile();\r\n  }, [user]);\r\n\r\n  const handleUpdate = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      setUpdating(true);\r\n      setError(null);\r\n      setSuccess(false);\r\n      \r\n      // Актуализиране или създаване на профилни данни\r\n      const { error } = await supabase\r\n        .from('profiles')\r\n        .upsert({\r\n          id: user.id,\r\n          full_name: name,\r\n          phone: phone,\r\n          updated_at: new Date()\r\n        });\r\n      \r\n      if (error) throw error;\r\n      \r\n      setSuccess(true);\r\n    } catch (error) {\r\n      console.error('Грешка при актуализиране на профила:', error);\r\n      setError('Възникна грешка при запазване на данните');\r\n    } finally {\r\n      setUpdating(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div style={{ padding: '20px', textAlign: 'center', color: '#e0e0e0' }}>Зареждане на профил...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"auth-container\">\r\n      <div className=\"auth-card\" style={{ maxWidth: '600px' }}>\r\n        <h1>Моят профил</h1>\r\n        \r\n        {error && <div className=\"auth-error\">{error}</div>}\r\n        {success && (\r\n          <div style={{\r\n            backgroundColor: '#1e392a',\r\n            color: '#4cd964',\r\n            padding: '15px',\r\n            borderRadius: '8px',\r\n            marginBottom: '20px',\r\n            border: '1px solid #2a6239'\r\n          }}>\r\n            Профилът беше актуализиран успешно!\r\n          </div>\r\n        )}\r\n        \r\n        <form onSubmit={handleUpdate} className=\"auth-form\">\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"email\">Email</label>\r\n            <input\r\n              id=\"email\"\r\n              type=\"email\" \r\n              value={user?.email || ''}\r\n              disabled\r\n              className=\"disabled-input\"\r\n            />\r\n            <small style={{ color: '#aaaaaa', marginTop: '5px', display: 'block' }}>\r\n              Email адресът не може да бъде променян\r\n            </small>\r\n          </div>\r\n          \r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"name\">Име и фамилия</label>\r\n            <input\r\n              id=\"name\"\r\n              type=\"text\" \r\n              value={name}\r\n              onChange={(e) => setName(e.target.value)}\r\n              placeholder=\"Вашето име\"\r\n            />\r\n          </div>\r\n          \r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"phone\">Телефонен номер</label>\r\n            <input\r\n              id=\"phone\"\r\n              type=\"tel\" \r\n              value={phone}\r\n              onChange={(e) => setPhone(e.target.value)}\r\n              placeholder=\"Телефонен номер\"\r\n            />\r\n          </div>\r\n          \r\n          <button \r\n            type=\"submit\" \r\n            className=\"auth-button\"\r\n            disabled={updating}\r\n          >\r\n            {updating ? 'Запазване...' : 'Запази промените'}\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}