{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AdminDashboardSection(_ref){let{restaurant,supabase}=_ref;const[stats,setStats]=useState({reservationsToday:0,activeTables:0,totalTables:0,upcomingEvents:0});const[loading,setLoading]=useState(true);useEffect(()=>{if(!restaurant)return;const fetchStats=async()=>{try{setLoading(true);// Получаване на днешната дата във формат YYYY-MM-DD\nconst today=new Date().toISOString().split('T')[0];// Заявка за резервации днес\nconst{data:reservations,error:reservationsError}=await supabase.from('reservations').select('*').eq('restaurant_id',restaurant.id).eq('date',today).in('status',['confirmed','pending']);if(reservationsError)throw reservationsError;// Заявка за всички маси в ресторанта\nconst{data:tables,error:tablesError}=await supabase.from('tables').select('*').eq('restaurant_id',restaurant.id);if(tablesError)throw tablesError;// Заявка за предстоящи събития\nconst{data:events,error:eventsError}=await supabase.from('events').select('*').eq('restaurant_id',restaurant.id).gte('date',today);if(eventsError)throw eventsError;// Изчисляване на заетите маси\nconst reservedTableIds=reservations.map(r=>r.table_id);const activeTables=new Set(reservedTableIds).size;setStats({reservationsToday:reservations.length,activeTables,totalTables:tables.length,upcomingEvents:events?events.length:0});}catch(error){console.error('Error fetching dashboard stats:',error);}finally{setLoading(false);}};fetchStats();},[restaurant,supabase]);if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0417\\u0430\\u0440\\u0435\\u0436\\u0434\\u0430\\u043D\\u0435 \\u043D\\u0430 \\u0441\\u0442\\u0430\\u0442\\u0438\\u0441\\u0442\\u0438\\u043A\\u0430...\"});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"\\u0422\\u0430\\u0431\\u043B\\u043E: \",restaurant===null||restaurant===void 0?void 0:restaurant.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0420\\u0435\\u0437\\u0435\\u0440\\u0432\\u0430\\u0446\\u0438\\u0438 \\u0434\\u043D\\u0435\\u0441\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat\",children:stats.reservationsToday})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0410\\u043A\\u0442\\u0438\\u0432\\u043D\\u0438 \\u043C\\u0430\\u0441\\u0438\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"stat\",children:[stats.activeTables,\"/\",stats.totalTables]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041F\\u0440\\u0435\\u0434\\u0441\\u0442\\u043E\\u044F\\u0449\\u0438 \\u0441\\u044A\\u0431\\u0438\\u0442\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"p\",{className:\"stat\",children:stats.upcomingEvents})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"quick-actions\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0411\\u044A\\u0440\\u0437\\u0438 \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-buttons-grid\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"admin-action-btn\",onClick:()=>window.location.href=`/admin/restaurant/${restaurant===null||restaurant===void 0?void 0:restaurant.id}/reservations`,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus\"}),\" \\u041D\\u043E\\u0432\\u0430 \\u0440\\u0435\\u0437\\u0435\\u0440\\u0432\\u0430\\u0446\\u0438\\u044F\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"admin-action-btn\",onClick:()=>window.location.href=`/admin/restaurant/${restaurant===null||restaurant===void 0?void 0:restaurant.id}/events`,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-plus\"}),\" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438 \\u0441\\u044A\\u0431\\u0438\\u0442\\u0438\\u0435\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"admin-action-btn\",onClick:()=>window.location.href=`/admin/restaurant/${restaurant===null||restaurant===void 0?void 0:restaurant.id}/menu`,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-utensils\"}),\" \\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043D\\u0430 \\u043C\\u0435\\u043D\\u044E\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-info-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F \\u0437\\u0430 \\u0440\\u0435\\u0441\\u0442\\u043E\\u0440\\u0430\\u043D\\u0442\\u0430\"}),restaurant?/*#__PURE__*/_jsxs(\"div\",{className:\"restaurant-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0418\\u043C\\u0435:\"}),\" \",restaurant.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0410\\u0434\\u0440\\u0435\\u0441:\"}),\" \",restaurant.address||'Не е зададен']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D:\"}),\" \",restaurant.phone||'Не е зададен']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0420\\u0430\\u0431\\u043E\\u0442\\u043D\\u043E \\u0432\\u0440\\u0435\\u043C\\u0435:\"}),\" \",restaurant.hours||'Не е зададено']}),restaurant.description&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435:\"}),\" \",restaurant.description]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u044F\\u043C\\u0430 \\u0438\\u0437\\u0431\\u0440\\u0430\\u043D \\u0440\\u0435\\u0441\\u0442\\u043E\\u0440\\u0430\\u043D\\u0442\"})]})]});}export default AdminDashboardSection;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","AdminDashboardSection","_ref","restaurant","supabase","stats","setStats","reservationsToday","activeTables","totalTables","upcomingEvents","loading","setLoading","fetchStats","today","Date","toISOString","split","data","reservations","error","reservationsError","from","select","eq","id","in","tables","tablesError","events","eventsError","gte","reservedTableIds","map","r","table_id","Set","size","length","console","children","name","className","onClick","window","location","href","address","phone","hours","description"],"sources":["D:/Belezza/restaurant-chain-app/src/components/AdminDashboardSection.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\n\r\nfunction AdminDashboardSection({ restaurant, supabase }) {\r\n  const [stats, setStats] = useState({\r\n    reservationsToday: 0,\r\n    activeTables: 0,\r\n    totalTables: 0,\r\n    upcomingEvents: 0\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!restaurant) return;\r\n    \r\n    const fetchStats = async () => {\r\n      try {\r\n        setLoading(true);\r\n        \r\n        // Получаване на днешната дата във формат YYYY-MM-DD\r\n        const today = new Date().toISOString().split('T')[0];\r\n        \r\n        // Заявка за резервации днес\r\n        const { data: reservations, error: reservationsError } = await supabase\r\n          .from('reservations')\r\n          .select('*')\r\n          .eq('restaurant_id', restaurant.id)\r\n          .eq('date', today)\r\n          .in('status', ['confirmed', 'pending']);\r\n        \r\n        if (reservationsError) throw reservationsError;\r\n        \r\n        // Заявка за всички маси в ресторанта\r\n        const { data: tables, error: tablesError } = await supabase\r\n          .from('tables')\r\n          .select('*')\r\n          .eq('restaurant_id', restaurant.id);\r\n        \r\n        if (tablesError) throw tablesError;\r\n        \r\n        // Заявка за предстоящи събития\r\n        const { data: events, error: eventsError } = await supabase\r\n          .from('events')\r\n          .select('*')\r\n          .eq('restaurant_id', restaurant.id)\r\n          .gte('date', today);\r\n        \r\n        if (eventsError) throw eventsError;\r\n        \r\n        // Изчисляване на заетите маси\r\n        const reservedTableIds = reservations.map(r => r.table_id);\r\n        const activeTables = new Set(reservedTableIds).size;\r\n        \r\n        setStats({\r\n          reservationsToday: reservations.length,\r\n          activeTables,\r\n          totalTables: tables.length,\r\n          upcomingEvents: events ? events.length : 0\r\n        });\r\n      } catch (error) {\r\n        console.error('Error fetching dashboard stats:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchStats();\r\n  }, [restaurant, supabase]);\r\n\r\n  if (loading) {\r\n    return <div>Зареждане на статистика...</div>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>Табло: {restaurant?.name}</h1>\r\n      <div className=\"admin-stats-grid\">\r\n        <div className=\"admin-stat-card\">\r\n          <h3>Резервации днес</h3>\r\n          <p className=\"stat\">{stats.reservationsToday}</p>\r\n        </div>\r\n        \r\n        <div className=\"admin-stat-card\">\r\n          <h3>Активни маси</h3>\r\n          <p className=\"stat\">{stats.activeTables}/{stats.totalTables}</p>\r\n        </div>\r\n        \r\n        <div className=\"admin-stat-card\">\r\n          <h3>Предстоящи събития</h3>\r\n          <p className=\"stat\">{stats.upcomingEvents}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"quick-actions\">\r\n        <h2>Бързи действия</h2>\r\n        <div className=\"admin-buttons-grid\">\r\n          <button className=\"admin-action-btn\" onClick={() => window.location.href = `/admin/restaurant/${restaurant?.id}/reservations`}>\r\n            <i className=\"fas fa-plus\"></i> Нова резервация\r\n          </button>\r\n          <button className=\"admin-action-btn\" onClick={() => window.location.href = `/admin/restaurant/${restaurant?.id}/events`}>\r\n            <i className=\"fas fa-calendar-plus\"></i> Добави събитие\r\n          </button>\r\n          <button className=\"admin-action-btn\" onClick={() => window.location.href = `/admin/restaurant/${restaurant?.id}/menu`}>\r\n            <i className=\"fas fa-utensils\"></i> Управление на меню\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"admin-info-section\">\r\n        <h2>Информация за ресторанта</h2>\r\n        {restaurant ? (\r\n          <div className=\"restaurant-details\">\r\n            <p><strong>Име:</strong> {restaurant.name}</p>\r\n            <p><strong>Адрес:</strong> {restaurant.address || 'Не е зададен'}</p>\r\n            <p><strong>Телефон:</strong> {restaurant.phone || 'Не е зададен'}</p>\r\n            <p><strong>Работно време:</strong> {restaurant.hours || 'Не е зададено'}</p>\r\n            {restaurant.description && (\r\n              <p><strong>Описание:</strong> {restaurant.description}</p>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <p>Няма избран ресторант</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AdminDashboardSection;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}